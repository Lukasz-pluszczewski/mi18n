{"version":3,"file":"mi18n.mjs","sources":["../src/config.js","../src/i18nService.js","../src/i18nRedux.js","../src/index.js"],"sourcesContent":["const config = {\n  errors: {\n    i18n: {\n      namespaceNotFound: 'Namespace not found',\n      namespaceNotObject: 'Provided namespace is path to translation. Provide path to object containing translations to set a namespace',\n      translationNotFound: 'Translation not found',\n      translationNotString: 'Provided path points to object not string. To create scoped translator use namespace() method instead',\n      corruptedTranslations: 'Translations error. This is most likely caused by wrong type of data in translations object in redux state. Translation must always be string.',\n      pluralNotArray: 'Forms parameter for getPlural method is not an array',\n      pluralNotNumber: 'Number parameter for getPlural method is not a number',\n      PathNotProvided: 'Path to translations has not been provided',\n      PathFalsy: 'Path falsy'\n    },\n  },\n};\n\nexport default config;\n","import _ from 'lodash';\nimport debug from 'debug';\nimport config from './config';\n\n// Setting up logger\nconst logger = {\n  info(...args) {\n    debug('mi18n-redux:info')(...args);\n  },\n  error(...args) {\n    debug('mi18n-redux:error')(...args);\n  },\n  namespaceError(...args) {\n    debug('mi18n-redux:namespace-error')(...args);\n  }\n};\n\n/**\n * Replaces all occurrences of 'search' in 'string' with 'replace'\n * @param {string} string\n * @param {string|object} search string or object with search strings as keys and replaces strings as values\n * @param {string} replace\n * @return {string} string after replace\n */\nfunction replaceAll(string, search, replace) {\n  if (_.isPlainObject(search)) {\n    return _.reduce(search, (result, replace, search) => {\n      return replaceAll(result, search, replace);\n    }, string);\n  }\n  return string.replace(new RegExp(search, 'g'), replace);\n}\n\nexport const translatorFactory = {\n  cachedTranslators: {},\n  cachedState: null,\n\n  /**\n   * Creates translator and sets language and translations to those from state\n   * @param {object} state - {languageCode: 'en', translations: {[key]: 'text'}}\n   * @param {string} translatorNamespace\n   * @return {object} translator\n   */\n  getTranslator(state, translatorNamespace) {\n    // checking if translations changed, checking deep equality is too resource hungry\n    if (\n      translatorFactory.cachedState\n      && state.languageCode === translatorFactory.cachedState.languageCode\n    ) {\n      if (translatorFactory.cachedTranslators[translatorNamespace]) {\n        return translatorFactory.cachedTranslators[translatorNamespace];\n      }\n      logger.info(`No translator cached for namespace '${translatorNamespace || null}' in language ${state.languageCode}`);\n    } else {\n      logger.info(`Language changed from ${translatorFactory.cachedState ? translatorFactory.cachedState.languageCode : 'None'} to ${state.languageCode}. Requested namespace '${translatorNamespace || null}'. Clearing cache.`);\n      translatorFactory.cachedTranslators = {};\n      translatorFactory.cachedState = null;\n    }\n\n\n    const translator = {\n      state: state,\n      translatorNamespace: translatorNamespace,\n      pluralMap: {\n        default: number => number === 1 ? 0 : 1,\n        pl: number => {\n          const last = _.takeRight(number.toString().split(''), 1).join('');\n          const lastTwo = _.takeRight(number.toString().split(''), 2).join('');\n          if (number === 1) {\n            return 0;\n          }\n          if ( (last === '2' || last === '3' || last === '4')\n            && !(lastTwo === '12' || lastTwo === '13' || lastTwo === '14') ) {\n            return 1;\n          }\n          return 2;\n        },\n        en: number => number === 1 ? 0 : 1,\n      },\n\n      /**\n       * Replaces all occurrences of replace[keys] with replace[values]\n       * @param {string} string\n       * @param {object} replace\n       * @return {string} replaced string\n       */\n      replace(string, replace) {\n        const fixedReplaces = _.reduce(replace, (replaces, replace, search) => {\n          replaces[`{{${search}}}`] = replace;\n          return replaces;\n        }, {});\n        return replaceAll(string, fixedReplaces);\n      },\n\n      /**\n       * Chooses proper form from array of forms based on the number provided\n       * @param {number} number\n       * @param {array} forms\n       * @return {string} chosen form\n       */\n      getPlural(number, forms) {\n        if (!_.isArray(forms)) {\n          logger.error(`${config.errors.i18n.pluralNotArray}`, {\n            number,\n            forms,\n          });\n          return forms;\n        }\n        if (!_.isNumber(number)) {\n          logger.error(`${config.errors.i18n.pluralNotNumber}`, {\n            number,\n            forms,\n          });\n          return forms[0];\n        }\n        const pluralMap = translator.pluralMap[translator.state.languageCode] || translator.pluralMap.default;\n        return forms[pluralMap(number)];\n      },\n\n      /**\n       * Returns translations object optionally namespaced by path\n       * @param {string} path - optional\n       * @param {boolean} absolute - indicates if given path is absolute path and should not be preceded by translatorNamespace\n       * @return {object|string} optionally namespaced translations\n       */\n      getTranslations(path, absolute = false) {\n        let absolutePath = translator.translatorNamespace && !absolute ? translator.translatorNamespace : '';\n        if (_.isString(path) && path) {\n          if (absolutePath) {\n            absolutePath = `${absolutePath}.${path}`;\n          } else {\n            absolutePath = path;\n          }\n        }\n        if (absolutePath) {\n          return _.get(translator.state.translations, absolutePath);\n        }\n        return translator.state.translations;\n      },\n\n      /**\n       * Returns current language code\n       * @return {string} language code\n       */\n      getLanguage() {\n        return translator.state.languageCode;\n      },\n\n      /**\n       * Returns new instance of translator with part of the translations from given namespacePath\n       * @param {string} namespacePath\n       * @param {boolean} absolute - indicates if given namespace is absolute path and should not be preceded by translatorNamespace\n       * @return {object} translator\n       */\n      namespace(namespacePath, absolute = false) {\n        const absolutePath = translator.translatorNamespace && !absolute ? `${translator.translatorNamespace}.${namespacePath}` : namespacePath;\n        if (_.isString(absolutePath) && absolutePath) {\n          const namespacedTranslations = _.get(translator.state.translations, absolutePath);\n          if (!namespacedTranslations) {\n            logger.namespaceError(config.errors.i18n.namespaceNotFound, {\n              language: translator.state.languageCode,\n              translatorNamespace: translator.translatorNamespace,\n              providedNamespace: namespacePath,\n              absolute,\n              absolutePath,\n            });\n          } else if (_.isString(namespacedTranslations)) {\n            logger.namespaceError(config.errors.i18n.namespaceNotObject, {\n              language: translator.state.languageCode,\n              translatorNamespace: translator.translatorNamespace,\n              providedNamespace: namespacePath,\n              absolute,\n              absolutePath,\n              foundNamespace: namespacedTranslations,\n            });\n          }\n        }\n        return translatorFactory.getTranslator(state, absolutePath);\n      },\n      n(namespacePath, absolute = false) {\n        return translator.namespace(namespacePath, absolute);\n      },\n\n      getTranslatedString(path, replace = null, number = null) {\n        // checking if path is not provided\n        if (!arguments.length) {\n          logger.error(`${config.errors.i18n.PathNotProvided}: \"${joinedPath}\"`, {\n            language: translator.state.languageCode,\n            translatorNamespace: translator.translatorNamespace,\n            providedPath: path,\n            absolutePath: joinedPath,\n          });\n          throw new Error(config.errors.i18n.PathNotProvided);\n        }\n\n        // checking if provided falsy path (but not empty string)\n        if (!path && path !== '') {\n          logger.error(`${config.errors.i18n.PathFalsy}: \"\"`, {\n            language: translator.state.languageCode,\n            translatorNamespace: translator.translatorNamespace,\n            providedPath: path,\n            typeofProvidedPath: typeof path,\n            absolutePath: '',\n          });\n          return { result: '', joinedPath: '' };\n        }\n\n        const filteredPath = _.filter([translator.translatorNamespace, path], path => _.isString(path) && path);\n        if (!filteredPath.length) {\n          throw new Error(config.errors.i18n.PathNotProvided);\n        }\n        const joinedPath = filteredPath.join('.');\n        let result = _.get(translator.state.translations, joinedPath, false);\n        if (result === false) {\n          logger.error(`${config.errors.i18n.translationNotFound}: \"${joinedPath}\"`, {\n            language: translator.state.languageCode,\n            translatorNamespace: translator.translatorNamespace,\n            providedPath: path,\n            absolutePath: joinedPath,\n          });\n          return { result, joinedPath };\n        }\n        if (_.isPlainObject(result)) {\n          logger.error(`${config.errors.i18n.translationNotString}`, {\n            language: translator.state.languageCode,\n            translatorNamespace: translator.translatorNamespace,\n            providedPath: path,\n            absolutePath: joinedPath,\n            foundTranslation: result,\n          });\n          return { result, joinedPath };\n        }\n        if (_.isArray(result)) {\n          result = translator.getPlural(number, result);\n        }\n        if (!_.isString(result)) {\n          throw new Error(config.errors.i18n.corruptedTranslations);\n        }\n\n        if (replace) {\n          result = translator.replace(result, replace);\n        }\n\n        return { result, joinedPath };\n      },\n      translateWithCallback(path, replace = null, number = null, cb = str => str) {\n        const result = translator.getTranslatedString(path, replace, number);\n        if (result.result === false) {\n          return result.joinedPath;\n        }\n        return cb(result.result);\n      },\n\n      /**\n       * Translates given path\n       * @param {string} path\n       * @param {object} replace\n       * @param {number} number\n       * @return {string} translated text or path when not found\n       */\n      translate(path, replace = null, number = null) {\n        const result = translator.getTranslatedString(path, replace, number);\n        if (result.result === false) {\n          return result.joinedPath;\n        }\n        return result.result;\n      },\n    };\n\n    // creating chainable translator with helper methods\n    const getTranslatorCallback = flags => translatedString => {\n      let transformedString = translatedString;\n      _.forEach(flags, (flagName) => {\n        transformedString = _[flagName](transformedString);\n      });\n      return transformedString;\n    };\n    const createChainableTranslator = (flags = []) => ({\n      capitalize() {\n        return createChainableTranslator([\n          ...flags,\n          'capitalize',\n        ]);\n      },\n      toUpper() {\n        return createChainableTranslator([\n          ...flags,\n          'toUpper',\n        ]);\n      },\n      toLower() {\n        return createChainableTranslator([\n          ...flags,\n          'toLower',\n        ]);\n      },\n      camelCase() {\n        return createChainableTranslator([\n          ...flags,\n          'camelCase',\n        ]);\n      },\n      lowerCase() {\n        return createChainableTranslator([\n          ...flags,\n          'lowerCase',\n        ]);\n      },\n      lowerFirst() {\n        return createChainableTranslator([\n          ...flags,\n          'lowerFirst',\n        ]);\n      },\n      snakeCase() {\n        return createChainableTranslator([\n          ...flags,\n          'snakeCase',\n        ]);\n      },\n      kebabCase() {\n        return createChainableTranslator([\n          ...flags,\n          'kebabCase',\n        ]);\n      },\n      startCase() {\n        return createChainableTranslator([\n          ...flags,\n          'startCase',\n        ]);\n      },\n      titleCase() {\n        return createChainableTranslator([\n          ...flags,\n          'startCase',\n        ]);\n      },\n      upperCase() {\n        return createChainableTranslator([\n          ...flags,\n          'upperCase',\n        ]);\n      },\n      upperFirst() {\n        return createChainableTranslator([\n          ...flags,\n          'upperFirst',\n        ]);\n      },\n      deburr() {\n        return createChainableTranslator([\n          ...flags,\n          'deburr',\n        ]);\n      },\n      translate(path, replace = null, number = null) {\n        return translator.translateWithCallback(path, replace, number, getTranslatorCallback(flags));\n      },\n      t(path, replace = null, number = null) {\n        return translator.translateWithCallback(path, replace, number, getTranslatorCallback(flags));\n      }\n    });\n\n    _.assign(translator, createChainableTranslator());\n\n    translatorFactory.cachedTranslators[translatorNamespace] = translator;\n    translatorFactory.cachedState = state;\n    return translator;\n  },\n\n};\n\n\nexport default translatorFactory.getTranslator;\n","const SET_LANGUAGE_ACTION = '@@SET_LANGUAGE';\nconst initialState = {\n  languageCode: '',\n  translations: {},\n};\n\n\n/* ----- Redux actions ------ */\n\n/**\n * setLanguage - action for setting language\n *\n * @param  {string} languageCode\n * @param  {object} translations object with translations\n * @return {object} action\n */\nexport function setLanguage(languageCode, translations) {\n  return {\n    type: SET_LANGUAGE_ACTION,\n    payload: { languageCode, translations },\n  };\n}\n\n/**\n * Reducer for managing language change\n * @param {object} state\n * @param {object} action\n * @return {object} new state\n */\nexport function reducer(state = initialState, action) {\n  switch (action.type) {\n    case SET_LANGUAGE_ACTION:\n      return {\n        ...state,\n        languageCode: action.payload.languageCode,\n        translations: action.payload.translations,\n      };\n    default:\n      return state;\n  }\n}\n\nexport const actionType = SET_LANGUAGE_ACTION;\n","import getT from './i18nService';\nimport {\n  setLanguage as setLangImport,\n  reducer as reducerImport,\n  actionType as actionTypeImport,\n} from './i18nRedux';\n\nexport default getT;\n\nexport const setLanguage = setLangImport;\nexport const reducer = reducerImport;\nexport const SET_LANGUAGE_ACTION = actionTypeImport;\n"],"names":["config","logger","replaceAll","string","search","replace","_","isPlainObject","reduce","result","RegExp","translatorFactory","state","translatorNamespace","cachedState","languageCode","cachedTranslators","info","translator","number","last","takeRight","toString","split","join","lastTwo","fixedReplaces","replaces","forms","isArray","error","errors","i18n","pluralNotArray","isNumber","pluralNotNumber","pluralMap","default","path","absolute","absolutePath","isString","get","translations","namespacePath","namespacedTranslations","namespaceError","namespaceNotFound","namespaceNotObject","getTranslator","namespace","arguments","length","PathNotProvided","joinedPath","Error","PathFalsy","filteredPath","filter","translationNotFound","translationNotString","getPlural","corruptedTranslations","cb","str","getTranslatedString","getTranslatorCallback","transformedString","translatedString","forEach","flags","flagName","createChainableTranslator","translateWithCallback","assign","SET_LANGUAGE_ACTION","initialState","setLanguage","reducer","action","type","payload","actionType","setLangImport","reducerImport","actionTypeImport"],"mappings":"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"}